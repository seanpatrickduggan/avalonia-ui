<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:conv="using:LogViewer.UI.Converters"
        xmlns:vm="using:LogViewer.UI"
        x:Class="LogViewer.UI.MainWindow"
        Title="Log Viewer" Width="1100" Height="700">
  <Window.DataContext>
    <vm:MainWindowViewModel />
  </Window.DataContext>
  <Grid RowDefinitions="Auto,Auto,*" RowSpacing="6" Margin="12">
    <StackPanel Orientation="Horizontal" Spacing="8">
      <TextBlock Text="Log File:" VerticalAlignment="Center"/>
      <TextBox Width="520" Text="{Binding LogFilePath, UpdateSourceTrigger=PropertyChanged}" Watermark="Paste or type path"/>
      <Button Content="Browse" Command="{Binding BrowseCommand}"/>
      <Button Content="Reload" Command="{Binding ReloadCommand}"/>
      <CheckBox Content="Tail" IsChecked="{Binding Tail}"/>
    </StackPanel>
    <WrapPanel Grid.Row="1" VerticalAlignment="Center">
      <StackPanel Orientation="Horizontal" Spacing="4" Margin="0,0,10,0">
        <CheckBox Content="Trace" IsChecked="{Binding ShowTrace}"/>
        <CheckBox Content="Debug" IsChecked="{Binding ShowDebug}"/>
        <CheckBox Content="Info" IsChecked="{Binding ShowInfo}"/>
        <CheckBox Content="Warn" IsChecked="{Binding ShowWarning}"/>
        <CheckBox Content="Error" IsChecked="{Binding ShowError}"/>
        <CheckBox Content="Crit" IsChecked="{Binding ShowCritical}"/>
      </StackPanel>
      <ComboBox Width="140" ItemsSource="{Binding Categories}" SelectedItem="{Binding SelectedCategory}" PlaceholderText="Category" Margin="0,0,10,0"/>
      <ComboBox Width="140" ItemsSource="{Binding Subcategories}" SelectedItem="{Binding SelectedSubcategory}" PlaceholderText="Subcategory" Margin="0,0,10,0"/>
      <TextBox Width="220" Watermark="Search..." Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"/>
      <Button Content="Clear" Command="{Binding ClearFiltersCommand}" Margin="6,0"/>
      <Button Content="Export" Command="{Binding ExportFilteredCommand}"/>
      <TextBlock Text="{Binding StatusMessage}" Margin="12,0,0,0" VerticalAlignment="Center" Opacity="0.7"/>
    </WrapPanel>
    <Border Grid.Row="2" BorderThickness="1" CornerRadius="4" Padding="4">
      <ScrollViewer>
        <ItemsControl ItemsSource="{Binding Entries}">
          <ItemsControl.ItemTemplate>
            <DataTemplate>
              <DockPanel Margin="2" LastChildFill="True">
                <Border Width="6" Background="{Binding Level, Converter={x:Static conv:LogSeverityToBrushConverter.Instance}}" Margin="0,0,6,0"/>
                <TextBlock Text="{Binding TsUtc}" FontSize="11"/>
                <TextBlock Text=" | " FontSize="11"/>
                <TextBlock Text="{Binding Level}" FontWeight="Bold" FontSize="11"/>
                <TextBlock Text=" | " FontSize="11"/>
                <TextBlock Text="{Binding Category}" FontSize="11"/>
                <TextBlock Text="/" FontSize="11"/>
                <TextBlock Text="{Binding Subcategory}" FontSize="11"/>
                <TextBlock Text=": " FontSize="11"/>
                <TextBlock Text="{Binding Message}" FontSize="11" TextWrapping="Wrap"/>
              </DockPanel>
            </DataTemplate>
          </ItemsControl.ItemTemplate>
        </ItemsControl>
      </ScrollViewer>
    </Border>
  </Grid>
</Window>
